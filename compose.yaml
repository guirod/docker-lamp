volumes:
  db-data:

services:
  docker-lamp-mysql:
    image: mysql:8
    command: --default-authentication-plugin=mysql_native_password
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: p@ssw0rd
    volumes:
      - db-data:/var/lib/mysql
    ports:
      - "3306:3306"

  docker-lamp-php:
    build: 
      dockerfile: Dockerfile-apache
    volumes:
      - ../:/var/www/html/
    ports:
      - "80:80"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      XDEBUG_MODE: develop,debug
      XDEBUG_CONFIG: client_host=host.docker.internal start_with_request=yes

  mailhog:
    image: mailhog/mailhog:latest
    restart: always
    ports:
      - "1025:1025"
      - "8025:8025"

  node:
    image: node:20
    user: node
    working_dir: "/home/node/app"
    environment:
      - NODE_ENV=production
      - PORT=8888
    volumes: 
      - ../node_apps:/home/node/app
    expose:
      - "8888"
    command: npm start

